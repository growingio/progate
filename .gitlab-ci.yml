image: uhub.service.ucloud.cn/growing/gradle:7.2-jdk11

stages:
  - test

test:
  stage: test
  script:
    - ./gradlew test
  coverage: '/    - Instruction Coverage: ([0-9.]+)%/'
  artifacts:
    when: always
    reports:
      junit: "*/build/test-results/test/**/TEST-*.xml"

include:
  - template: Code-Quality.gitlab-ci.yml

code_quality:
  image: uhub.service.ucloud.cn/growing_public/docker:19.03.12
  variables:
    CODE_QUALITY_IMAGE: "uhub.service.ucloud.cn/growing/codequality:latest"
